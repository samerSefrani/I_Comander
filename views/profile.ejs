<!DOCTYPE html>
<html>
<head>


<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <meta charset="utf-8">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>


    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css">    <!--[if lte IE 8]>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css">
    <!--<![endif]--></head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
<link rel="stylesheet" type="text/css" href="/style/icmd.css">


    <title>Profile</title>

</head>

<style>

    body{
        background: white;
    }
    .pure-g {
        background: #A8DADC;
        border-radius: 1em;
        margin: 0em;
    }
 /* At the top level of your code */
    @media screen and (min-width: 35.5em){
    .pure-g {
     margin: 3em;
    }
    }

</style>

<body>



<div id="layout">
    <%include partials/dashboard_menu.ejs%>

    <div id="main">

    <div class="pure-g ">
        <div class="pure-u-1 pure-u-md-1-2">
            <H1>Profile</H1>

            <p>Welcome <%=user.displayName%></p>

            <p><%=user.username%></p>

            <button class="pure-button-primary" data-toggle="collapse" data-target="#changepw">Change password</button>


        </div>
        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1-3" style="padding: 2em">

            <img name="preview" src="<%=user.base64data%>" height="200" alt="Image preview">


            <p>Your Emails are:<%=user.email%></p>
            <p>Current Role: <%=user.role%></p>

            <%switch (user.role) {
                case 'Guest':%>
            <p>Please ask your Administrator to grant permission to Fly</p>
            <button class="pure-button-primary">Request Access</button>

            <%break;
                case 'admin':
                case 'superadmin': %>
            <p>Admins Have full permissions manage Users Drones And More From the Dashboard</p>

            <%break;
            }%>

        </div>
        <div id="changepw" class="pure-u-1 collapse">
            <form id='edit_user' class="pure-form pure-form-aligned"
                  action="/api/edit_profile" method="post" style="border: black; border-style: solid; height: 100%">

                <fieldset>
                    <div class="pure-control-group">
                        <input id="base64photo" hidden name="base64photo" value="">
                        <label for="photo">Profile Photo</label>

                        <input name="photo" type="file" onchange="previewFile()">
                    </div>
                    <div class="pure-control-group">
                        <label for="preview">Photo Preview</label>
                        <img name="preview" src="" height="200" alt="Image preview">
                    </div>
                    <script>
                        function previewFile() {
                              var preview = document.querySelector('img');
                              var file    = document.querySelector('input[type=file]').files[0];
                              var reader  = new FileReader();
                              var input = document.getElementById("base64photo");
                              reader.addEventListener("load", function () {
                                preview.src = reader.result;
                                input.value = reader.result;
                                console.log(reader.result);
                              }, false);

                              if (file) {
                                reader.readAsDataURL(file);
                              }
                            }
                    </script>


                    <div class="pure-control-group">
                        <label for="displayName">Display Name</label>
                        <input name="displayName" type="text" placeholder="<%=user.displayName%>" value="<%=user.displayName%>">
                    </div>
                    <div class="pure-control-group">
                        <label for="email">Email Address</label>
                        <input name="email" type="email" placeholder="Email" value="<%=user.email%>" >
                    </div>
                    <div class="pure-control-group">
                        <label for="oldpassword">Current Password</label>
                        <input name="oldpassword" type="password" placeholder="Current Password">
                    </div>
                    <div class="pure-control-group">
                        <label for="newpassword">New Password</label>
                        <input name="newpassword" type="password" placeholder="New Password">
                    </div>



                    <div class="pure-controls" >
                        <button type="submit" class="pure-button pure-button-primary" style="float: left">Submit</button>
                    </div>
                </fieldset>
                <span>
                test
            <img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MEVBMTczNDg3QzA5MTFFNjk3ODM5NjQyRjE2RjA3QTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MEVBMTczNDk3QzA5MTFFNjk3ODM5NjQyRjE2RjA3QTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowRUExNzM0NjdDMDkxMUU2OTc4Mzk2NDJGMTZGMDdBOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowRUExNzM0NzdDMDkxMUU2OTc4Mzk2NDJGMTZGMDdBOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PjjUmssAAAGASURBVHjatJaxTsMwEIbpIzDA6FaMMPYJkDKzVYU+QFeEGPIKfYU8AETkCYI6wANkZQwIKRNDB1hA0Jrf0rk6WXZ8BvWkb4kv99vn89kDrfVexBSYgVNwDA7AN+jAK3gEd+AlGMGIBFDgFvzouK3JV/lihQTOwLtOtw9wIRG5pJn91Tbgqk9kSk7GViADrTD4HCyZ0NQnomi51sb0fUyCMQEbp2WpU67IjfNjwcYyoUDhjJVcZBjYBy40j4wXgaobWoe8Z6Y80CJBwFpunepIzt2AUgFjtXXshNXjVmMh+K+zzp/CMs0CqeuzrxSRpbOKfdCkiMTS1VBQ41uxMyQR2qbrXiiwYN3ACh1FDmsdK2Eu4J6Tlo31dYVtCY88h5ELZIJJ+IRMzBHfyJINrigNkt5VsRiub9nXICdsYyVd2NcVvA3ScE5t2rb5JuEeyZnAhmLt9NK63vX1O5Pe8XaPSuGq1uTrfUgMEp9EJ+CQvr+BJ/AAKvAcCiAR+bf9CjAAluzmdX4AEIIAAAAASUVORK5CYII=">
            </span>

            </form>

        </div>

    </div>

</div>
</div>

</body>
<script src="/js/icmd.js"></script>

</html>
